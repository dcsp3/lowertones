<div class="elements">
  <div class="options">
    <div class="tabs-container">
      <button
        type="button"
        class="top-artists-tab"
        (click)="setActiveTab('topArtists')"
        [class.active]="activeTab === 'topArtists'"
        [class.inactive]="activeTab !== 'playlists'"
      >
        Top Artists
      </button>
      <button
        type="button"
        class="playlists-tab"
        (click)="setActiveTab('playlists')"
        [class.active]="activeTab === 'playlists'"
        [class.inactive]="activeTab !== 'topArtists'"
      >
        Playlists
      </button>
    </div>

    <div *ngIf="activeTab === 'playlists'">
      <p-dropdown
        [options]="playlists"
        [(ngModel)]="selectedPlaylistId"
        (onChange)="onPlaylistChange($event.value)"
        [style]="{ width: '100%', 'min-width': '150px' }"
        placeholder="Select a playlist"
        styleClass="custom-dropdown"
      >
      </p-dropdown>
    </div>

    <div *ngIf="activeTab === 'topArtists'" class="termButtons">
      <button class="button" [class.selected]="timeRange === 'short-term'" (click)="changeTimeRange('short-term')">Last Month</button>
      <button class="button" [class.selected]="timeRange === 'medium-term'" (click)="changeTimeRange('medium-term')">Last 6 Months</button>
      <button class="button" [class.selected]="timeRange === 'long-term'" (click)="changeTimeRange('long-term')">Last Year</button>
    </div>

    <div class="showConnectionsCheckbox">
      <input type="checkbox" id="showConnectionsCheckbox" #connectionsCheckbox (change)="toggleConnections($event)" /> Show Connections
    </div>
  </div>

  <div class="content">
    <div class="graph" #graphContainer>
      <div *ngIf="displayGraphPlaceholder">Select a playlist to view the graph.</div>
    </div>
    <div class="stats">
      <div class="top-artist">
        <div class="stats-header">
          <span>{{ activeTab === 'topArtists' ? 'Top Artist' : 'Most Popular Artist' }}</span>
        </div>

        <div class="top-artist-container">
          <img [src]="topArtistImage" width="100px" height="100px" alt="Top Artist Image" id="topArtistImage" />
          <div class="sound-wave" *ngIf="isPlaying">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <!-- Add as many bars as you like -->
          </div>
          <div class="top-artist-text">
            <!-- Artist and Play Button -->
            <div *ngIf="topTrackName && topTrackPreviewUrl" class="artist-controls">
              <span id="topArtistName" class="truncate">{{ topArtistName }}</span>
              <button (click)="playPreview()" id="playButton">{{ isPlaying ? '❚❚' : '▶' }}</button>
            </div>
            <!-- Separate Track Name -->
            <div *ngIf="topTrackName && topTrackPreviewUrl" class="artist-track">
              <span id="topArtistTopTrack" class="truncate">{{ topTrackName }}</span>
            </div>
            <div *ngIf="!topTrackName || !topTrackPreviewUrl" class="artist-name-only">
              <span id="topArtistName" class="truncate">{{ topArtistName }}</span>
              <span class="no-track-info">No track preview available</span>
            </div>
          </div>
        </div>
      </div>

      <div class="top-genre">
        <div class="stats-header">
          <span>{{ activeTab === 'topArtists' ? 'Top Genre' : 'Main Genre' }}</span>
        </div>

        <div class="top-genre-container">
          <div id="topGenre" class="truncate">{{ topGenre }}</div>
        </div>
      </div>

      <div class="mainstream-score">
        <div class="stats-header">
          <span>{{ activeTab === 'topArtists' ? 'Mainstream Factor' : 'Playlist Mainstream Factor' }}</span>
        </div>
        <div class="mainstream-score-container" *ngIf="tasteCategoryDetails">
          <div class="score-bar" [ngStyle]="{ 'background-color': tasteCategoryDetails.colorDark }">
            <div
              class="score-fill"
              [@fillAnimation]="{ value: 'end', params: { fillPercentage: displayScore } }"
              [ngStyle]="{ 'background-color': tasteCategoryDetails.colorLight }"
            ></div>
            <span class="popularity-score">{{ displayScore }}%</span>
          </div>
          <span class="taste-category">{{ tasteCategoryDetails.name }}</span>
        </div>
      </div>

      <div class="share">
        <button>Share Network...</button>
        <button>How It Works</button>
      </div>
    </div>
  </div>
</div>
